---
- name: Deploy ARM Template using Parameters
  azure_rm_deployment:
    client_id: "{{ azure_client_id }}"
    secret: "{{ azure_secret }}"
    subscription_id: "{{ azure_subscription_id }}"
    tenant: "{{ azure_tenant }}"
    resource_group_name: "{{ azure_resource_group }}"
    location: "{{ azure_location }}"
    template_link: "{{ azure_template_link }}"
    parameters:
      newStorageAccountName: "{{ azure_storage_account_name }}"
      adminUsername: "{{ azure_admin_username }}"
      #adminPassword: Password1234 #"{{ azure_admin_password}}"
      dnsLabelPrefix: "{{ azure_vm_name }}"
      vmName: "{{ azure_vm_name }}"
      vmSize: "{{ azure_vm_size }}"
      windowsOSVersion: "{{ azure_windows_os_version }}"
      nicname: "{{ azure_network_interface_name }}"
      virtualNetworkName: "{{ azure_virtual_network_name }}"
      publicIPAddressName: "{{ azure_public_ip_name  }}"

    wait_for_deployment_completion: "{{ azure_wait_for_deployment_completion }}"
    wait_for_deployment_polling_period: "{{ azure_wait_for_deployment_polling_period }}"
    state: present
